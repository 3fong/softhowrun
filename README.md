## 程序是怎么跑起来的

CPU -> 二进制 -> 内存 -> 硬盘 -> 压缩 -> 操作系统 -> 可执行文件 -> 应用 -> 汇编语言 -> 硬件 -> BI -> C语言语法

### CPU

- 程序是什么
- 程序由什么组成
- 什么是机器语言
- 运行中的程序存储在哪里
- 什么是内存地址
- 计算机的组件中,哪个负责程序的解释和运行?
- CPU的运行机制

CPU:central processing unit 中央处理器.负责解释和运行程序内容.    
IC=CPU+内存    
CPU=寄存器,控制器,运算器,时钟     
寄存器: 暂存指令,数据等处理对象,内存的一部分.一个CPU有20-100个寄存器    
控制器:把内存指令,数据读入到寄存器,并根据指令的执行结果控制整个计算机    
运算器: 运算从内存读入寄存器的数据    
时钟: 发出CPU开始计时的时钟信号     

内存: 指计算机的主存储器(main memory),简称主存.通过控制芯片等于CPU相连,主要负责存储指令和数据.

程序运行机制: 程序启动后,根据时钟信号,控制器从内存读取指令和数据后,进行解释和运行;运算器对数据进行运算.控制器根据该运行结果来控制计算机.    
控制:数据运算之外的处理,主要是数据输入输出的时机控制.如键盘的输入输出等.

- 寄存器

CPU的核心是寄存器,因为程序把寄存器作为对象来描述.    
汇编: 汇编语言编写的程序转化成机器语言的过程;    
反汇编: 机器语言程序转化成汇编语言的过程

```
mov eax, dword ptr [ebp-8]   把数值从内存复制到eax    
add eax, dword ptr [ebp-0Ch] eax的数据和内存的数值相加    
mov dword ptr [ebp-4], eax   把eax的数值存储到内存
```
上面是汇编语言转成成机器语言的程序执行情况.机器语言级别的程序是通过寄存器来处理的.CPU是寄存器的集合体

程序的处理过程就是将高级语言程序编译后转化为机器语言,再通过CPU内部的寄存器等进行处理.

寄存器可以分为8类.寄存器的存储内容可以是指令也可以是数据.    
数据:运算数值,内存地址的数值    

![寄存器分类](https://upload-images.jianshu.io/upload_images/4933701-4cc3831e6b621953.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp)

程序计数器,累加寄存器,标志寄存器,指令寄存器和栈寄存器只有一个,其他的一般有多个

- 计数器

cpu计数器存放下一条指令的执行地址.CPU控制器每次读取计数器的地址来获取内存中的数据,完成程序的执行.

1 程序的流程与计数器

程序的流程: 顺序执行,条件执行,循环.    
程序的流程是通过计数器来控制指令执行顺序,通过标志寄存器来决定条件和循环的跳转行为;标志寄存器中存储了当前执行的运算结果;

![条件分支下的计数器](https://img1.baidu.com/it/u=3728839880,2864243253&fm=253&fmt=auto&app=138&f=JPG?w=991&h=500)

2 函数与计数器

函数调用处理通过把程序计数器的值设置为函数的存储地址.但函数的调用需要入口地址和出口地址,单纯的计数器无法在一个计数上标记两个地址.
这时就需要栈首先存入函数执行结束后的地址,函数执行结束后将结果值读取并设定到程序计数器中对应的地址上.函数执行完全在栈中完成即可.

![函数与计数器-栈](https://img0.baidu.com/it/u=3382044954,2575628411&fm=253&fmt=auto&app=138&f=PNG?w=635&h=479)

- 基址寄存器和变址寄存器与数组

通过基址寄存器和变址寄存器将内存上特点的区域划分,实现数组的功能.基址寄存器相当于数组的起始角标,变址寄存器相当于索引,两个地址组合即可获取到对象的实际存储位置.

机器语言指令类型和功能:    

> 数据转送指令：寄存器和内存、内存核内存、寄存器和外围设置之间的数据读写操作    
运算指令：用累加寄存器执行算术运算、逻辑运算、比较运算、移位运算    
跳转指令：实现条件分支、循环、强制跳转等    
call/return指令：函数的调用/返回调用前的地址    


















